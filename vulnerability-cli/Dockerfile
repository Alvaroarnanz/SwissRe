# Usa una imagen de .NET 8 SDK
FROM mcr.microsoft.com/dotnet/sdk:8.0-windowsservercore-ltsc2022 AS build
WORKDIR /app

# Copia el proyecto y restaura dependencias
COPY ["vulnerability-cli/vulnerability-cli.csproj", "./"]
RUN dotnet restore

# Copia el resto del código
COPY . .

# Compila el proyecto
RUN dotnet publish -c Release -o /publish

# Imagen base para producción
FROM mcr.microsoft.com/dotnet/runtime:8.0-windowsservercore-ltsc2022 AS base
WORKDIR /app

# Copia la publicación al contenedor final
COPY --from=build /publish .

# Define el punto de entrada
ENTRYPOINT ["dotnet", "vulnerability-cli.dll"]