namespace VulnerabilityCLI.Services;

public class ArgumentValidator
{
    public bool IsValidArgs(string[] args)
    {
        // Validar argumentos
        if (args.Length != 4 || args[0] != "--file" || args[2] != "--url")
        {
            Console.WriteLine("Error: Arguments are not correct.");
            return false;
        }

        string filePath = args[1];
        string apiUrl = args[3];

        if (string.IsNullOrWhiteSpace(filePath) || !File.Exists(filePath))
        {
            Console.WriteLine("Error: The file path is invalid or the file does not exist.");
            return false;
        }

        if (string.IsNullOrWhiteSpace(apiUrl) || !Uri.IsWellFormedUriString(apiUrl, UriKind.Absolute))
        {
            Console.WriteLine("Error: The URL is invalid.");
            return false;
        }

        return true;
    }
}
