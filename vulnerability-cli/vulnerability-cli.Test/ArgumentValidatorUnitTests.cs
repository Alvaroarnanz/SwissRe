using VulnerabilityCLI.Services;
using Xunit;

namespace vulnerability_cli.Test
{
    public class ArgumentValidatorTests
    {
        [Fact]
        public void IsValidArgs_ShouldReturnTrue_WhenArgumentsAreValid()
        {
            // Arrange
            var filePath = Path.GetTempFileName(); // Crear un archivo temporal
            File.WriteAllText(filePath, "{}");
            var args = new[] { "--file", filePath, "--url", "https://example.com/api" };

            var validator = new ArgumentValidator();

            // Act
            var result = validator.IsValidArgs(args);

            // Assert
            Assert.True(result);

            // Cleanup
            File.Delete(filePath);
        }


        [Fact]
        public void IsValidArgs_ShouldReturnFalse_WhenArgumentsAreInvalid()
        {
            // Arrange
            var args = new[] { "--invalid", "value" };
            var validator = new ArgumentValidator();

            // Act
            var result = validator.IsValidArgs(args);

            // Assert
            Assert.False(result);
        }
    }

}